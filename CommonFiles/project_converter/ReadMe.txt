
	Описанный ниже набор скриптов на языке JavaScript предназначен для конвертации файлов проектов MS VisualStudio 6.0 в файлы проектов MS VisualStudio 2005 в соответствии с принятыми соглашениями о размещении выходных и промежуточных файлов, названиями конфигураций и т.д.

-------------------------------------------------

ПРЕДУПРЕЖДЕНИЕ!
	Данные скрипты поставляются "как есть", без каких-либо гарантий их работы! Вы можете использовать данные скрипты только на свой страх и риск! Автор не несет никакой ответственности за проблемы, возникшие при использовании скриптов!

-------------------------------------------------

Общие замечания при использовании скриптов.

	Для запуска скриптов Microsoft (R) Windows Script Host версии 5.6. С другими версиями работа скриптов не проверялась. 

Запуск производится следующим образом:
	cscript <имя скрипта> <аргументы>


-------------------------------------------------
Скрипт converter.wsf

Этот скрипт производит первоначальную конвертацию файла проекта MS VisualStudio 6.0 в файл проекта MS Visual Studio 2005.

Использование: 

	csrcript converter.wsf /src:value [/dst:value] [/overwrite[+|-]]

Опции:

	src       : Имя исходного dsp-файла проекта MS VisualStudio 6.0.
	dst       : Имя конечного vcproj-файла проекта MS VisualStudio 2005. Если имя файла не указано, то оно будет взято из опции /src и расширение файла будет изменено на .vcproj.
	overwrite : Переписывать файл, если он уже существует. ВНИМАНИЕ! Используйте эту опцию с осторожностью!

Пример:

	csrcript converter.wsf /src:c:\foo.dsp /dst:c:\foo.vcproj

Комментарий:

	Скрипт производит конвертацию проекта с помощью ActiveX объекта MS VisualStudio 2005.

-------------------------------------------------
Скрипт patcher.wsf

Этот скрипт производит изменение некоторых опций проекта в соответствии с принятыми соглашениями.

Использование: 

	csrcript patcher.wsf /src:value [/dst:value] /path:value [/overwrite[+|-]] [/correct[+|-]] 

Опции:

	src       : Имя исходного vcproj-файла проекта MS VisualStudio 2005.
	dst       : Имя конечного vcproj-файла проекта MS VisualStudio 2005. Если имя файла не указано, то оно будет взято из опции /src.
	overwrite : Переписывать файл, если он уже существует. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	correct   : Переименовывать имя проекта	в соответствии с именем файла проекта. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	path      : Абсолютный путь в каталог, где размешаются каталоги out_* и temp_*. С его помощью формируется относительный путь к каталогам out_* и temp_*. 

Пример:

	csrcript patcher.wsf /src:c:\foo.vsproj /dst:c:\foo_new.vcproj /path:c:\

Комментарии:

	Скрипт производит изменение некоторых опций проекта в соответствии с следующими принятыми соглашениями:
	- конфигурации Debug и Release в отсутствие конфигураций DebugDll и Release Dll подразумевают динамическую сборку. Если в проекте присутствуют конфигурации DebugDll или ReleaseDll, то конфигурации Debug и Release подразумевают статическую сборку.
	- имена каталогов конфигураций со статической сборкой формируются путем добавления символа 'S' в конце имени конфигурации, например DebugS.
	- выходные файлы должны размещаться в каталоге out_*/<имя каталога конфигурации>, где * - имя платформы (например Win32).
	- промежуточные файлы должны размещаться в каталоге temp_*/<имя каталога конфигурации>/<путь до проекта>, где * - имя платформы (например Win32), <путь до проекта> - путь от каталога /path до каталога проекта.
	- опция "C/C++\Code Generation\Runtime Library" для проектов неисполняемых файлов исправляется в соответствии с конфигурацией. В случае исходного несовпадения будет выдано предупреждение.
	- имена каталогов нестандартных конфигурации формируются из имени конфигурации и для таких конфигураций выдается предупреждение. 

-------------------------------------------------
Скрипт addplatform.wsf

Этот скрипт добавляет в проект платформы, для которых планируется компиляция.

Использование: 

	csrcript addplatform.wsf /src:value [/dst:value] /platform:value [/overwrite[+|-]] 

Опции:

	src       : Имя исходного vcproj-файла проекта MS VisualStudio 2005.
	dst       : Имя конечного vcproj-файла проекта MS VisualStudio 2005. Если имя не указано, то имя будет взято из опции /src .
	overwrite : Переписывать файл, если он уже существует. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	platform  : Имя платформы для добавления.

Пример:

	csrcript addplatform.wsf /src:c:\foo.vcproj /platform:x64

Комментарии:
	
	Скрипт добавляет платформу, копирует для этой платформы все конфигурации и производит некоторые изменения в опциях. В настоящее время можно добавить только платформу 'x64'.

-------------------------------------------------
Скрипт confert_dsp.wsf

Этот скрипт производит конвертацию файла проекта MS VisualStudio 6.0 в файл проекта MS Visual Studio 2005.

Использование: 

	csrcript convert_dsp.wsf /src:value [/dst:value] /path:value [/overwrite[+|-]] [/correct[+|-]] 

Опции:

	src       : Имя исходного dsp-файла проекта MS VisualStudio 6.0.
	dst       : Имя конечного vcproj-файла проекта MS VisualStudio 2005. Если имя файла не указано, то оно будет взято из опции /src и расширение файла будет изменено на .vcproj.
	overwrite : Переписывать файл, если он уже существует. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	correct   : Если не указана опция /dst, то переименовать имя проекта и имя файла проекта в соответствии с именем каталога, где размещается файл проекта. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	x64       : дублирует все конфигурации для платформы x64 (значение по умолчанию - TRUE)
	path      : Абсолютный путь в каталог, где размешаются каталоги out_* и temp_*. С его помощью формируется относительный путь к каталогам out_* и temp_*. 

Пример:

	csrcript convert_dsp.wsf /src:c:\foo.dsp /path:c:\

Комментарии:
	
	Скрипт последовательно вызывает для файла проекта /src скрипты converter.wsf, patcher.wsf и addplatform.wsf

-------------------------------------------------
Скрипт convert_all.wsf

Этот скрипт производит конвертацию всех файлов проектов MS VisualStudio 6.0 в файлы проектов MS Visual Studio 2005 в указанном каталоге.

Использование: 

	csrcript convert_all.wsf /dir:value [/outdir:value] [/overwrite[+|-]] [/correct[+|-]]

Опции:

	dir       : (default=".") Каталог в котором будет производиться поиск и конвертация dsp-файлов проектов.
	outdir    : Абсолютный путь в каталог, где размешаются каталоги out_* и temp_*. С его помощью формируется относительный путь к каталогам out_* и temp_*. 
	overwrite : Переписывать файлы, если они уже существуют. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	correct   : Если в каталоге размещается один файл проекта, то переименовать имя проекта и имя файла проекта в соответствии с именем каталога, где размещается файл проекта. ВНИМАНИЕ! Используйте эту опцию с осторожностью!
	x64       : (default="+") дублирует все конфигурации для платформы x64

Пример:

	csrcript convert_all.wsf /dir:c:\foo /outdir:c:\
