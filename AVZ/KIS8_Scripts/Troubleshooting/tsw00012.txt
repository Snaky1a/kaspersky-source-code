// $AVZ1512
//$ Ограничение отображения дисков в проводнике
// Функция поиска проблемы                                                                          
function Check : dword;
begin
 Result := 0;
 // Блокировка отображения дисков - вариант 1
 if RegKeyIntParamRead('HKCU', 'Software\Microsoft\Windows\CurrentVersion\Policies\Explorer', 'NoViewOnDrive') > 0 then begin
   Result := 3;
   exit;
  end;
 // Блокировка отображения дисков - вариант 2
 if RegKeyIntParamRead('HKCU', 'Software\Microsoft\Windows\CurrentVersion\Policies\Explorer', 'NoDrives') > 0 then begin
   Result := 3;
   exit;
  end;
end;

// Функция исправления проблемы                                                                          
function Fix : dword;
begin
 RegKeyParamDel('HKCU', 'Software\Microsoft\Windows\CurrentVersion\Policies\Explorer', 'NoViewOnDrive');
 RegKeyParamDel('HKCU', 'Software\Microsoft\Windows\CurrentVersion\Policies\Explorer', 'NoDrives');
 Result := 0;
end;
